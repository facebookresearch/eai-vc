# @package _global_

defaults:
  - /experiments/imisra/0161_vitb16_laion1b-25Mroll_b32K_sunrgbd_b4K_audioset_b32K_cg5_slr1e-3_elr1e-5_maskgatherloss_linheads_ep32


constants:
  loss_wt_audio_video: 1.0
  loss_wt_image_depth: 1.0

trainer:
  max_epochs: 16
  optim:
    options:
      lr:
      - scheduler:
          _target_: fvcore.common.param_scheduler.CompositeParamScheduler
          schedulers:
          - _target_: fvcore.common.param_scheduler.LinearParamScheduler
            start_value: 1e-06
            end_value: 5e-4
          - _target_: fvcore.common.param_scheduler.CosineParamScheduler
            start_value: ${..0.end_value}
            end_value: 1e-5
          lengths:
          - ${divide:${constants.warmup_epochs},${trainer.max_epochs}}
          - ${subtract:1,${divide:${constants.warmup_epochs},${trainer.max_epochs}}}
          interval_scaling:
          - rescaled
          - rescaled
  checkpoint:
    model_weight_initializer:
      _partial_: True
      _target_: omnivision.model.checkpoint_utils.load_state_dict_into_model
      strict: False # we have missing keys for depth, audio
      state_dict:
        _target_: omnivision.model.checkpoint_utils.load_checkpoint
        pick_recursive_keys:
          - "model"
        path_list:
          - /fsx-omnivore/imisra/omnivision_omnivore/config/experiments/imisra/0164_vitb16_shared_p-2-16-16_laion1b-25Mroll_b32K_cg5_slr1e-3_elr1e-5_maskgatherloss_ep32.yaml/0/checkpoints/checkpoint.pt
