# @package _global_
defaults:
  - mannatsingh/uru10x10/fine_tune/inat18_ft_vith_mae_init_518

trainer:
  data:
    train:
      dataset:
        new_prefix: /checkpoint/omniscale_oss/datasets/inat_dataset/train_val2018/
        path_file_list:
          - /checkpoint/omniscale_oss/datasets_meta/inat18/train_images.npy
        label_file_list:
          - /checkpoint/omniscale_oss/datasets_meta/inat18/train_labels.npy
    val:
      dataset:
        new_prefix: /checkpoint/omniscale_oss/datasets/inat_dataset/train_val2018/
        path_file_list:
          - /checkpoint/omniscale_oss/datasets_meta/inat18/val_images.npy
        label_file_list:
          - /checkpoint/omniscale_oss/datasets_meta/inat18/val_labels.npy


  model:
    trunk:
      embed_dim: 2560
      depth: 24
      attn_target:
        num_heads: 32
    heads:
      - head:
          _target_: omnivision.model.model_init_utils.init_parameters
          model:
            _target_: torch.nn.Linear
            in_features: 2560
            out_features: ${scratch.num_classes}
          init_fns:
            weight:
              _target_: torch.nn.init.zeros_
              _partial_: True
            bias:
              _target_: torch.nn.init.zeros_
              _partial_: True
        fork_module: ""
        input_key: NULL
        output_key: NULL


  checkpoint:
    model_weight_initializer:
      state_dict:
        checkpoint_path: /checkpoint/omniscale_oss/uru10x10/checkpoints/vit_gpt2b14_5b_tool.torch

submitit:
  constraints: NULL
